<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Cluster Based Sparse Canonical Correlation Analayis to Test Associations Between A Multi-Pollutant Mixture and High-Dimentional DNA Methylation • AclustsCCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A Cluster Based Sparse Canonical Correlation Analayis to Test Associations Between A Multi-Pollutant Mixture and High-Dimentional DNA Methylation">
<meta property="og:description" content="Provides a framework for estimating the assocation between multiple exposures and high-dimensional DNA methylation outcomes.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">AclustsCCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Step by Step Guide</li>
    <li>
      <a href="articles/Intro_to_Aclust.html">Step 1: Implement A-clustering</a>
    </li>
    <li>
      <a href="articles/Intro_to_Partial_Residuals.html">Step 2: Obtain Partial Residuals</a>
    </li>
    <li>
      <a href="articles/Intro_to_SparseCCA.html">Step 3: Implement SparseCCA on each clusterg</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level2">
<h2 id="0-what-is-aclustscca">0. What is AclustsCCA?<a class="anchor" aria-label="anchor" href="#0-what-is-aclustscca"></a>
</h2>
<p>The framework of <code>AclustsCCA</code> consists of two parts The goal of AclustsCCA is to …</p>
</div>
<div class="section level2">
<h2 id="1-installation">1. Installation<a class="anchor" aria-label="anchor" href="#1-installation"></a>
</h2>
<p>You can install the released version of AclustsCCA from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"AclustsCCA"</span><span class="op">)</span></code></pre></div>
<p>And the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"jennyjyounglee/AclustsCCA"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"tamartsi/Aclust"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">AclustsCCA</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Aclust</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="2-input-parameters-for-aclustscca">2. Input Parameters for AclustsCCA<a class="anchor" aria-label="anchor" href="#2-input-parameters-for-aclustscca"></a>
</h2>
<p>The below is a list of input parameters:</p>
<div class="section level3">
<h3 id="21-input-data">2.1 Input data<a class="anchor" aria-label="anchor" href="#21-input-data"></a>
</h3>
<p><strong><code>X</code></strong> by exposure data matrix, where is sample size and is number of exposures.</p>
<p><strong><code>Y</code></strong> by outcome data matrix, where is sample size and is number of outcomes.</p>
<p><strong><code>Z</code></strong> by confounder data matrix, where is sample size and is number of confounders. If <code>NULL</code>, partial residuals are used for SparseCCA analysis.</p>
<p><strong><code>clusters.list</code></strong> A list of clusters with CpG sites obtained using A-clustering, each item is a cluster that contains a set of probes. A-clustering is implemented if <code>NULL</code> or can be provided by users.</p>
<p><strong><code>annot</code></strong> A preloaded annotation file that includes columns “IlmnID”, “CHR”, “Coordinate_37”, “Islands_Name”, “Relation_to_Island”, “UCSC_RefGene_Name”. Only needed if <strong><code>clusters.list</code></strong> is <code>NULL</code>.</p>
</div>
<div class="section level3">
<h3 id="22-input-parameters-associated-with-a-clustering">2.2 Input parameters associated with A-clustering:<a class="anchor" aria-label="anchor" href="#22-input-parameters-associated-with-a-clustering"></a>
</h3>
<p><strong><code>dist.type</code></strong> A type of similarity distance function. Options are “spearman” (default), “pearson” (correlation measures) or “euclid”.</p>
<p><strong><code>Aclust.method</code></strong> A type of clustering function. Options are “single”, “complete” or “average” (default).</p>
<p><strong><code>dist.thresh</code></strong> A similarity distance threshold. Two neighboring clusters are merged to a single cluster if the similarity distance between them is above dist.thresh. Corresponds to <em>D̄</em> in the paper and the default is 0.2</p>
<p><strong><code>bp.thresh.clust</code></strong> Optional maximum length between neighboring variables permitting to cluster them together. Corresponds to <em>d̄</em><sub>*b**p*</sub> in the paper and the default is 1000.</p>
<p><strong><code>bp.merge</code></strong> A distance in chromosomal location. Any set of methylation sites within an interval smaller or equal to bp.dist will be potentially merged, depending on the similarity between sites at the ends of the interval. Corresponds to <span class="math inline">$\\underline{d}\_{bp}$</span> in the paper and the default is 999.</p>
</div>
<div class="section level3">
<h3 id="23-input-parameters-associated-with-sparsecca">2.3 Input parameters associated with SparseCCA:<a class="anchor" aria-label="anchor" href="#23-input-parameters-associated-with-sparsecca"></a>
</h3>
<p><strong><code>Xmethod</code></strong> A penalty function for the exposure, i.e. penalty function when regressing Y onto X. Options are “lasso”, “alasso”,“gglasso”, and “SGL” (default).</p>
<p><strong><code>Ymethod</code></strong> A penalty function for the outcome, i.e. penalty function when regressing X onto Y. Options are “lasso”, “alasso”,“gglasso”, “SGL”, and “OLS” (default).</p>
<p><strong><code>init.method</code></strong> Initialization method. Options are “lasso”, “OLS”, and “SVD” (default).</p>
<p><strong><code>X.groupidx</code></strong> A vector of length that indicates grouping structure of exposure .</p>
<p><strong><code>standardize</code></strong> A logical flag for exposure and outcome standardization, prior to fitting the model.</p>
<p><strong><code>max.iter</code></strong> A maximum number of iterations of SparseCCA. The default is 100.</p>
<p><strong><code>conv</code></strong> A tolerance value for convergence of SparseCCA. The default is 0.01.</p>
</div>
</div>
<div class="section level2">
<h2 id="14-input-parameters-associated-permutation-test-for-aclustscca">1.4 Input parameters associated permutation test for AclustsCCA:<a class="anchor" aria-label="anchor" href="#14-input-parameters-associated-permutation-test-for-aclustscca"></a>
</h2>
<p><strong><code>maxnum</code></strong> A maximal total number of permutations across all the clusters.</p>
<p><strong><code>maxB</code></strong> A maximal number of permutations for a single cluster.</p>
<p><strong><code>permute.tmp.filepath</code></strong> Filepath to save intermittent permutation results.</p>
<p><strong><code>permute</code></strong> A logical flag for whether to run permutation test or not.</p>
<p><strong><code>nthread</code></strong> A number of threads to parallelize permutation test and implementation of SparseCCA across all the clusters.</p>
<p><strong><code>FDR.thresh</code></strong> FDR threshold. The default is 0.05.</p>
</div>
<div class="section level2">
<h2 id="3-implementation-of-aclustscca">3. Implementation of AclustsCCA<a class="anchor" aria-label="anchor" href="#3-implementation-of-aclustscca"></a>
</h2>
<p>The framework of <code>AclustsCCA</code> consists of two parts:</p>
<ol style="list-style-type: decimal">
<li><p>Implement A-clustering on DNA methylation data</p></li>
<li><p>Implement SparseCCA on each cluster identified by A-clustering</p></li>
</ol>
<ul>
<li><p>When implementing SparseCCA, partial residuals are used to adjust for potential confounders</p></li>
<li><p>For statistical inference, permutation test is performed</p></li>
</ul>
<p>This entire process can be done using the code below, but I personally DO NOT suggest this for computational time and memory. Please read the next section for the suggested way of running <code>AclustsCCA</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load annotation file</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(annot) <span class="co"># row: CpG sites</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load sample data</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(sample.data)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>DATA.X <span class="ot">&lt;-</span> sample.data<span class="sc">$</span>DATA.X <span class="co"># row: subjects (n), column: exposures (p)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>DATA.Y <span class="ot">&lt;-</span> sample.data<span class="sc">$</span>DATA.Y <span class="co"># row: subjects (n), column: CpG sites (q)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>DATA.Z <span class="ot">&lt;-</span> sample.data<span class="sc">$</span>DATA.Z <span class="co"># row: subjects (n), column: confounders (r)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Settings for Aclust</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>dist.type <span class="ot">&lt;-</span> <span class="st">"spearman"</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>Aclust.method <span class="ot">&lt;-</span> <span class="st">"average"</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>dist.thresh <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>bp.thresh.clust <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>bp.merge <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Settings for SparseCCA</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>Xmethod <span class="ot">&lt;-</span> <span class="st">"lasso"</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>Ymethod <span class="ot">&lt;-</span> <span class="st">"lasso"</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>X.groupidx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>maxB <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>nthread <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>AclustsCCA.result <span class="ot">&lt;-</span> <span class="fu">AclustsCCA</span>(<span class="at">X=</span>DATA.X,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Y=</span>DATA.Y,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Z=</span>DATA.Z,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                                <span class="at">clusters.list=</span><span class="cn">NULL</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                                <span class="at">annot=</span>annot,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># parameters for A-clustering</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dist.type =</span> dist.type,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method =</span> Aclust.method,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dist.thresh =</span> dist.thresh,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                                <span class="at">bp.thresh.clust =</span> bp.thresh.clust,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                                <span class="at">bp.merge =</span> bp.merge</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># parameters for SparseCCA</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Xmethod=</span>Xmethod,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Ymethod=</span>Ymethod,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                                <span class="at">X.groupidx=</span>X.groupidx,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># parameters for permutation test for AclustsCCA</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                                <span class="at">h=</span>hBH,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                                <span class="at">permute=</span><span class="cn">TRUE</span>,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>                                <span class="at">maxB=</span>maxB,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>                                <span class="at">nthread=</span>nthread)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="fu">summary_AclustsCCA</span>(<span class="at">obj=</span>AclustsCCA.result,<span class="at">annot=</span>annot,<span class="at">n.top=</span><span class="dv">5</span>)</span></code></pre></div>
<p>If you want to run more permutation test, then increase either <strong><code>maxnum</code></strong> or <strong><code>maxB</code></strong> and use the funtion <strong><code>AclustsCCA.cont</code></strong>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maxB</span> <span class="op">&lt;-</span> <span class="fl">500</span> 
<span class="va">AclustsCCA.result.updated</span> <span class="op">&lt;-</span> <span class="fu">AclustsCCA.cont</span><span class="op">(</span>obj<span class="op">=</span><span class="va">AclustsCCA.result</span>,X<span class="op">=</span><span class="va">AclustsCCA.result</span><span class="op">$</span><span class="va">X.resid</span>,Y<span class="op">=</span><span class="va">AclustsCCA.result</span><span class="op">$</span><span class="va">Y.resid</span>,maxB<span class="op">=</span><span class="va">maxB</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="4-suggestions-on-how-to-run-aclustscca">4. Suggestions on how to run AclustsCCA<a class="anchor" aria-label="anchor" href="#4-suggestions-on-how-to-run-aclustscca"></a>
</h2>
<p>The framework of <code>AclustsCCA</code> consists of two parts:</p>
<ol style="list-style-type: decimal">
<li><p>Implement A-clustering on DNA methylation data</p></li>
<li><p>Implement SparseCCA on each cluster identified by A-clustering</p></li>
</ol>
<ul>
<li><p>When implementing SparseCCA, partial residuals are used to adjust for potential confounders</p></li>
<li><p>For statistical inference, permutation test is performed</p></li>
</ul>
<p>All of the above procedures can be implemented at once using <code>AclustsCCA</code> function. Among these steps, permutation test is definitely a part that takes the most computational time to run and requires attention when running.</p>
<p>Therefore, I personally suggest running each part separately to save computational time and memory.</p>
<div class="section level3">
<h3 id="41-implement-a-clustering-and-save-it">4.1 Implement A-clustering and save it<a class="anchor" aria-label="anchor" href="#41-implement-a-clustering-and-save-it"></a>
</h3>
<p>A-clustering is implemented to identify cluster and this part have to be ran only once. I personally suggest to run this part separately and save it for future use.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Implement A-clustering</span>
<span class="va">all.clusters.list</span> <span class="op">&lt;-</span> <span class="fu">Aclust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Aclust/man/assign.to.clusters.html" class="external-link">assign.to.clusters</a></span><span class="op">(</span>betas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">DATA.Y</span><span class="op">)</span>,
                                                annot <span class="op">=</span> <span class="va">annot</span>,
                                                dist.type <span class="op">=</span> <span class="va">dist.type</span>,
                                                method <span class="op">=</span> <span class="va">Aclust.method</span>,
                                                dist.thresh <span class="op">=</span> <span class="va">dist.thresh</span>,
                                                bp.thresh.clust <span class="op">=</span> <span class="va">bp.thresh.clust</span>,
                                                bp.merge <span class="op">=</span> <span class="va">bp.merge</span><span class="op">)</span>
<span class="co"># Summarize the result</span>
<span class="fu"><a href="reference/summary_Aclustering.html">summary_Aclustering</a></span><span class="op">(</span><span class="va">all.clusters.list</span>,<span class="va">annot</span><span class="op">)</span>

<span class="co"># We only need clusters with at least two probes</span>
<span class="va">clusters.list</span> <span class="op">&lt;-</span> <span class="va">all.clusters.list</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">all.clusters.list</span>,<span class="va">length</span><span class="op">)</span><span class="op">!=</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="42-obtain-partial-residuals-to-adjust-for-potential-confounders">4.2 Obtain partial residuals to adjust for potential confounders<a class="anchor" aria-label="anchor" href="#42-obtain-partial-residuals-to-adjust-for-potential-confounders"></a>
</h3>
<p>When implementing SparseCCA, partial residuals are used to adjust for potential confounders. Again, computing partial residuals have to be ran only once. I personally suggest to run this part separately and save it for future use.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X.resid</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/partial.residual.html">partial.residual</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">DATA.X</span>,Z<span class="op">=</span><span class="va">DATA.Z</span>,nthread<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">Y.resid</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/partial.residual.html">partial.residual</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">DATA.Y</span>,Z<span class="op">=</span><span class="va">DATA.Z</span>,nthread<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="43-implement-sparsecca-and-permutation-test-on-each-cluster-identified-by-a-clustering">4.3 Implement SparseCCA and permutation test on each cluster identified by A-clustering<a class="anchor" aria-label="anchor" href="#43-implement-sparsecca-and-permutation-test-on-each-cluster-identified-by-a-clustering"></a>
</h3>
<p>As list of clusters are provided and partial residuals are computed, <code>AclustsCCA</code> will only run SparseCCA on each cluster identified by A-clustering.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AclustsCCA.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AclustsCCA.html">AclustsCCA</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">X.resid</span>,
                                Y<span class="op">=</span><span class="va">Y.resid</span>,
                                clusters.list<span class="op">=</span><span class="va">clusters.list</span>,
                                <span class="co"># parameters for SparseCCA</span>
                                Xmethod<span class="op">=</span><span class="va">Xmethod</span>,
                                Ymethod<span class="op">=</span><span class="va">Ymethod</span>,
                                X.groupidx<span class="op">=</span><span class="va">X.groupidx</span>,
                                <span class="co"># parameters for permutation test for AclustsCCA</span>
                                maxB<span class="op">=</span><span class="va">maxB</span>,
                                permute<span class="op">=</span><span class="cn">TRUE</span>,
                                nthread<span class="op">=</span><span class="va">nthread</span><span class="op">)</span> </code></pre></div>
<p>If you want to run more permutation test, then increase either <strong><code>maxnum</code></strong> or <strong><code>maxB</code></strong> and use the funtion <strong><code>AclustsCCA.cont</code></strong>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AclustsCCA.result.updated</span> <span class="op">&lt;-</span> <span class="fu">AclustsCCA.cont</span><span class="op">(</span>obj<span class="op">=</span><span class="va">AclustsCCA.result</span>,
                                             X<span class="op">=</span><span class="va">X.resid</span>,
                                             Y<span class="op">=</span><span class="va">Y.resid</span>,
                                             maxB<span class="op">=</span><span class="va">maxB</span><span class="op">*</span><span class="fl">1.5</span><span class="op">)</span></code></pre></div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing AclustsCCA</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jenny Lee <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Jenny Lee.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
