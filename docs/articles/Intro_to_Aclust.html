<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Step 1: Implement A-clustering • AclustsCCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Step 1: Implement A-clustering">
<meta property="og:description" content="AclustsCCA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AclustsCCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Step by Step Guide</li>
    <li>
      <a href="../articles/Intro_to_Aclust.html">Step 1: Implement A-clustering</a>
    </li>
    <li>
      <a href="../articles/Intro_to_Partial_Residuals.html">Step 2: Obtain Partial Residuals</a>
    </li>
    <li>
      <a href="../articles/Intro_to_SparseCCA.html">Step 3: Implement SparseCCA on each clusterg</a>
    </li>
    <li>
      <a href="../articles/Intro_to_Errors.html">Possible Errors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Step 1: Implement A-clustering</h1>
                        <h4 data-toc-skip class="author">Jenny Lee</h4>
            
            <h4 data-toc-skip class="date">2021-12-26</h4>
      
      
      <div class="hidden name"><code>Intro_to_Aclust.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="what-is-a-clustering">1. What is A-clustering?<a class="anchor" aria-label="anchor" href="#what-is-a-clustering"></a>
</h2>
<p>A-clustering is a statistical method …. <span class="citation">(Sofer et al. 2013)</span>.</p>
<p>Here is the link for more detailed explanation of the <a href="https://academic.oup.com/bioinformatics/article/29/22/2884/314757?login=true" class="external-link">A-clustering method</a> and <a href="https://github.com/tamartsi/Aclust/tree/master/man" class="external-link">Aclust R package</a>.</p>
</div>
<div class="section level2">
<h2 id="input-parameters-for-a-clustering">2. Input Parameters for A-clustering<a class="anchor" aria-label="anchor" href="#input-parameters-for-a-clustering"></a>
</h2>
<p><strong><code>Y</code></strong>  by  outcome data matrix, where  is sample size and  is number of outcomes.</p>
<p><strong><code>annot</code></strong> A preloaded annotation file that includes columns “IlmnID,” “CHR,” “Coordinate_37,” “Islands_Name,” “Relation_to_Island,” “UCSC_RefGene_Name.”</p>
<p><strong><code>dist.type</code></strong> A type of similarity distance function. Options are “spearman” (default), “pearson” (correlation measures) or “euclid.”</p>
<p><strong><code>Aclust.method</code></strong> A type of clustering function. Options are “single,” “complete” or “average” (default).</p>
<p><strong><code>dist.thresh</code></strong> A similarity distance threshold. Two neighboring clusters are merged to a single cluster if the similarity distance between them is above <strong><code>dist.thresh</code></strong>. Corresponds to <span class="math inline">\(\bar{D}\)</span> in the <a href="https://academic.oup.com/bioinformatics/article/29/22/2884/314757?login=true" class="external-link">A-clustering paper</a> paper and the default is <span class="math inline">\(0.2\)</span></p>
<p><strong><code>bp.thresh.clust</code></strong> Optional maximum length between neighboring variables permitting to cluster them together. Corresponds to <span class="math inline">\(\bar{d}_{bp}\)</span> in the <a href="https://academic.oup.com/bioinformatics/article/29/22/2884/314757?login=true" class="external-link">A-clustering paper</a> paper and the default is <span class="math inline">\(1000\)</span>.</p>
<p><strong><code>bp.merge</code></strong> A distance in chromosomal location. Any set of methylation sites within an interval smaller or equal to bp.dist will be potentially merged, depending on the similarity between sites at the ends of the interval. Corresponds to <span class="math inline">\(\underline{d}_{bp}\)</span> in the <a href="https://academic.oup.com/bioinformatics/article/29/22/2884/314757?login=true" class="external-link">A-clustering paper</a> and the default is <span class="math inline">\(999\)</span>.</p>
</div>
<div class="section level2">
<h2 id="implementation-of-a-clustering">3. Implementation of A-clustering<a class="anchor" aria-label="anchor" href="#implementation-of-a-clustering"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load annotation file</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span> <span class="co"># row: CpG sites</span>
<span class="co"># Load sample data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample.data</span><span class="op">)</span>
<span class="va">DATA.X</span> <span class="op">&lt;-</span> <span class="va">sample.data</span><span class="op">$</span><span class="va">DATA.X</span> <span class="co"># row: subjects (n), column: exposures (p)</span>
<span class="va">DATA.Y</span> <span class="op">&lt;-</span> <span class="va">sample.data</span><span class="op">$</span><span class="va">DATA.Y</span> <span class="co"># row: subjects (n), column: CpG sites (q)</span>

<span class="co"># Settings for Aclust</span>
<span class="va">dist.type</span> <span class="op">&lt;-</span> <span class="st">"spearman"</span>
<span class="va">Aclust.method</span> <span class="op">&lt;-</span> <span class="st">"average"</span>
<span class="va">dist.thresh</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>
<span class="va">bp.thresh.clust</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="va">bp.merge</span> <span class="op">&lt;-</span> <span class="fl">999</span>

<span class="co"># Implement A-clustering</span>
<span class="va">all.clusters.list</span> <span class="op">&lt;-</span> <span class="fu">Aclust</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Aclust/man/assign.to.clusters.html" class="external-link">assign.to.clusters</a></span><span class="op">(</span>betas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">DATA.Y</span><span class="op">)</span>,
                                                annot <span class="op">=</span> <span class="va">annot</span>,
                                                dist.type <span class="op">=</span> <span class="va">dist.type</span>,
                                                method <span class="op">=</span> <span class="va">Aclust.method</span>,
                                                dist.thresh <span class="op">=</span> <span class="va">dist.thresh</span>,
                                                bp.thresh.clust <span class="op">=</span> <span class="va">bp.thresh.clust</span>,
                                                bp.merge <span class="op">=</span> <span class="va">bp.merge</span><span class="op">)</span>
<span class="co"># We only need clusters with at least two probes</span>
<span class="va">clusters.list</span> <span class="op">&lt;-</span> <span class="va">all.clusters.list</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">all.clusters.list</span>,<span class="va">length</span><span class="op">)</span><span class="op">!=</span><span class="fl">1</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">clusters.list</span>,<span class="st">"clusters.list.RData"</span><span class="op">)</span> 
<span class="co"># identical(clusters.list,sample.data$clusters.list) TRUE</span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-sofer2013clustering" class="csl-entry">
Sofer, Tamar, Elizabeth D Schifano, Jane A Hoppin, Lifang Hou, and Andrea A Baccarelli. 2013. <span>“A-Clustering: A Novel Method for the Detection of Co-Regulated Methylation Regions, and Regions Associated with Exposure.”</span> <em>Bioinformatics</em> 29 (22): 2884–91.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jenny Lee.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
