<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to AclustsCCA • AclustsCCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to AclustsCCA">
<meta property="og:description" content="AclustsCCA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AclustsCCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Introduction</li>
    <li>
      <a href="../articles/Intro_to_AclustsCCA.html">Introduction to AclustsCCA</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Step by Step Guide</li>
    <li>
      <a href="../articles/Intro_to_Aclust.html">Step 1: Implement A-clustering</a>
    </li>
    <li>
      <a href="../articles/Intro_to_Partial_Residuals.html">Step 2: Obtain Partial Residuals</a>
    </li>
    <li>
      <a href="../articles/Intro_to_SparseCCA.html">Step 3: Implement SparseCCA on each clusterg</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to AclustsCCA</h1>
                        <h4 data-toc-skip class="author">Jenny Lee</h4>
            
            <h4 data-toc-skip class="date">2021-12-10</h4>
      
      
      <div class="hidden name"><code>Intro_to_AclustsCCA.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="what-is-aclustscca">1. What is AclustsCCA?<a class="anchor" aria-label="anchor" href="#what-is-aclustscca"></a>
</h2>
</div>
<div class="section level2">
<h2 id="input-parameters-for-aclustscca">2. Input Parameters for AclustsCCA<a class="anchor" aria-label="anchor" href="#input-parameters-for-aclustscca"></a>
</h2>
<p>The below is a list of input parameters:</p>
<div class="section level3">
<h3 id="input-data">2.1 Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h3>
<div class="line-block">
<strong><code>X</code></strong>  by  exposure data matrix, where  is sample size and  is number of exposures.</div>
<div class="line-block">
<strong><code>Y</code></strong>  by  outcome data matrix, where  is sample size and  is number of outcomes.</div>
<div class="line-block">
<strong><code>Z</code></strong>  by  confounder data matrix, where  is sample size and  is number of confounders. If <code>NULL</code>, partial residuals are used for SparseCCA analysis.</div>
<div class="line-block">
<strong><code>clusters.list</code></strong> A list of clusters with CpG sites obtained using A-clustering, each item is a cluster that contains a set of probes. A-clustering is implemented if <code>NULL</code> or can be provided by users.</div>
<div class="line-block">
<strong><code>annot</code></strong> A preloaded annotation file that includes columns “IlmnID,” “Coordinate_37,” “Islands_Name,” “Relation_to_Island,” “UCSC_RefGene_Name.” Only needed if <strong><code>clusters.list</code></strong> is <code>NULL</code>.</div>
</div>
<div class="section level3">
<h3 id="input-parameters-associated-with-a-clustering">2.2 Input parameters associated with A-clustering:<a class="anchor" aria-label="anchor" href="#input-parameters-associated-with-a-clustering"></a>
</h3>
<div class="line-block">
<strong><code>dist.type</code></strong> A type of similarity distance function. Options are “spearman” (default), “pearson” (correlation measures) or “euclid.”</div>
<div class="line-block">
<strong><code>Aclust.method</code></strong> A type of clustering function. Options are “single,” “complete” or “average” (default).</div>
<div class="line-block">
<strong><code>thresh.dist</code></strong> A similarity distance threshold. Two neighboring clusters are merged to a single cluster if the similarity distance between them is above dist.thresh. Corresponds to <span class="math inline">\(\bar{D}\)</span> in the paper and the default is <span class="math inline">\(0.2\)</span>
</div>
<div class="line-block">
<strong><code>max.dist</code></strong> Optional maximum length between neighboring variables permitting to cluster them together. Corresponds to <span class="math inline">\(\bar{d}_{bp}\)</span> in the paper and the default is <span class="math inline">\(1000\)</span>.</div>
<div class="line-block">
<strong><code>bp.thresh.dist</code></strong> A distance in chromosomal location. Any set of methylation sites within an interval smaller or equal to bp.dist will be potentially merged, depending on the similarity between sites at the ends of the interval. Corresponds to <span class="math inline">\(\underline{d}_{bp}\)</span> in the paper and the default is <span class="math inline">\(999\)</span>.</div>
</div>
<div class="section level3">
<h3 id="input-parameters-associated-with-sparsecca">2.3 Input parameters associated with SparseCCA:<a class="anchor" aria-label="anchor" href="#input-parameters-associated-with-sparsecca"></a>
</h3>
<div class="line-block">
<strong><code>Xmethod</code></strong> A penalty function for the exposure, i.e. penalty function when regressing Y onto X. Options are “lasso,” “alasso,”“gglasso,” and “SGL” (default).</div>
<div class="line-block">
<strong><code>Ymethod</code></strong> A penalty function for the outcome, i.e. penalty function when regressing X onto Y. Options are “lasso,” “alasso,”“gglasso,” “SGL,” and “OLS” (default).</div>
<div class="line-block">
<strong><code>init.method</code></strong> Initialization method. Options are “lasso,” “OLS,” and “SVD” (default).</div>
<div class="line-block">
<strong><code>X.groupidx</code></strong> A vector of length  that indicates grouping structure of exposure .</div>
<div class="line-block">
<strong><code>Y.groupidx</code></strong> A vector of length  that indicates grouping structure of outcome .</div>
<div class="line-block">
<strong><code>standardize</code></strong> A logical flag for exposure  and outcome  standardization, prior to fitting the model.</div>
<div class="line-block">
<strong><code>max.iter</code></strong> A maximum number of iterations of SparseCCA. The default is <span class="math inline">\(100\)</span>.</div>
<div class="line-block">
<strong><code>conv</code></strong> A tolerance value for convergence  of SparseCCA. The default is <span class="math inline">\(10e-2\)</span>.</div>
</div>
</div>
<div class="section level2">
<h2 id="input-parameters-associated-permutation-test-for-aclustscca">1.4 Input parameters associated permutation test for AclustsCCA:<a class="anchor" aria-label="anchor" href="#input-parameters-associated-permutation-test-for-aclustscca"></a>
</h2>
<div class="line-block">
<strong><code>maxnum</code></strong> A maximal total number of permutations across all the clusters.</div>
<div class="line-block">
<strong><code>maxB</code></strong> A maximal number of permutations for a single cluster.</div>
<div class="line-block">
<strong><code>permute.tmp.filepath</code></strong> Filepath to save intermittent permutation results.</div>
<div class="line-block">
<strong><code>permute</code></strong> A logical flag for whether to run permutation test or not.</div>
<div class="line-block">
<strong><code>nthread</code></strong> A number of threads to parallelize permutation test and implementation of SparseCCA across all the clusters.</div>
<div class="line-block">
<strong><code>FDR.thresh</code></strong> FDR threshold. The default is <span class="math inline">\(0.05\)</span>.</div>
</div>
<div class="section level2">
<h2 id="implementation-of-aclustscca">3. Implementation of AclustsCCA<a class="anchor" aria-label="anchor" href="#implementation-of-aclustscca"></a>
</h2>
<p>The framework of <code>AclustsCCA</code> consists of two parts:</p>
<ol style="list-style-type: decimal">
<li><p>Implement A-clustering on DNA methylation data</p></li>
<li><p>Implement SparseCCA on each cluster identified by A-clustering</p></li>
</ol>
<ul>
<li><p>When implementing SparseCCA, partial residuals are used to adjust for potential confounders</p></li>
<li><p>For statistical inference, permutation test is performed</p></li>
</ul>
<p>This entire process can be done using the code below, but I personally DO NOT suggest this for computational time and memory. Please read the next section for the suggested way of running <code>AclustsCCA</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span> <span class="co"># row: CpG sites</span>
<span class="va">data.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.data.html">generate.data</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">500</span><span class="op">)</span>

<span class="va">DATA.X</span> <span class="op">&lt;-</span> <span class="va">data.list</span><span class="op">$</span><span class="va">DATA.X</span> <span class="co"># row: subjects (n), column: Metals (p)</span>
<span class="va">DATA.Y</span> <span class="op">&lt;-</span> <span class="va">data.list</span><span class="op">$</span><span class="va">DATA.Y</span> <span class="co"># row: subjects (n), column: CpG sites (q)</span>


<span class="va">dist.type</span> <span class="op">&lt;-</span> <span class="st">"spearman"</span>
<span class="va">Aclust.method</span> <span class="op">&lt;-</span><span class="st">"average"</span>
<span class="va">thresh.dist</span> <span class="op">&lt;-</span><span class="fl">0.2</span>
<span class="va">max.dist</span> <span class="op">&lt;-</span><span class="fl">1000</span>
<span class="va">bp.thresh.dist</span> <span class="op">&lt;-</span><span class="fl">999</span>

<span class="va">Xmethod</span> <span class="op">&lt;-</span> <span class="st">"lasso"</span>
<span class="va">Ymethod</span> <span class="op">&lt;-</span> <span class="st">"OLS"</span>
<span class="va">maxB</span> <span class="op">&lt;-</span> <span class="fl">300</span>
<span class="va">nthread</span> <span class="op">&lt;-</span> <span class="fl">2</span>

<span class="va">AclustsCCA.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AclustsCCA.html">AclustsCCA</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">DATA.X</span>,
                                Y<span class="op">=</span><span class="va">DATA.Y</span>,
                                clusters.list<span class="op">=</span><span class="cn">NULL</span>,
                                annot<span class="op">=</span><span class="va">annot</span>,
                                <span class="co"># parameters for A-clustering</span>
                                dist.type <span class="op">=</span> <span class="va">dist.type</span>,
                                Aclust.method <span class="op">=</span> <span class="va">Aclust.method</span>,
                                thresh.dist <span class="op">=</span> <span class="va">thresh.dist</span>,
                                max.dist <span class="op">=</span> <span class="va">max.dist</span>,
                                bp.thresh.dist <span class="op">=</span> <span class="va">bp.thresh.dist</span>,
                                <span class="co"># parameters for SparseCCA</span>
                                Xmethod<span class="op">=</span><span class="va">Xmethod</span>,
                                Ymethod<span class="op">=</span><span class="va">Ymethod</span>,
                                <span class="co"># parameters for permutation test for AclustsCCA</span>
                                maxB<span class="op">=</span><span class="va">maxB</span>,
                                nthread<span class="op">=</span><span class="va">nthread</span><span class="op">)</span>                         </code></pre></div>
</div>
<div class="section level2">
<h2 id="suggestions-on-how-to-run-aclustscca">4. Suggestions on how to run AclustsCCA<a class="anchor" aria-label="anchor" href="#suggestions-on-how-to-run-aclustscca"></a>
</h2>
<p>The framework of <code>AclustsCCA</code> consists of two parts:</p>
<ol style="list-style-type: decimal">
<li><p>Implement A-clustering on DNA methylation data</p></li>
<li><p>Implement SparseCCA on each cluster identified by A-clustering</p></li>
</ol>
<ul>
<li><p>When implementing SparseCCA, partial residuals are used to adjust for potential confounders</p></li>
<li><p>For statistical inference, permutation test is performed</p></li>
</ul>
<p>All of the above procedures can be implemented at once using <code>AclustsCCA</code> function. Among these steps, permutation test is definitely a part that takes the most computational time to run and requires attention when running.</p>
<p>Therefore, I personally suggest running each part separately to save computational time and memory.</p>
<div class="section level3">
<h3 id="implement-a-clustering-and-save-it">4.1 Implement A-clustering and save it<a class="anchor" aria-label="anchor" href="#implement-a-clustering-and-save-it"></a>
</h3>
<p>A-clustering is implemented to identify cluster and this part have to be ran only once. I personally suggest to run this part separately and save it for future use.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Implement A-clustering</span>
<span class="va">all.clusters.list</span> <span class="op">&lt;-</span> <span class="fu">assign.to.clusters</span><span class="op">(</span>betas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">DATA.Y</span><span class="op">)</span>, 
                                        annot <span class="op">=</span> <span class="va">annot</span>,
                                        dist.type <span class="op">=</span> <span class="va">dist.type</span>,
                                        method <span class="op">=</span> <span class="va">Aclust.method</span>,
                                        thresh.dist <span class="op">=</span> <span class="va">thresh.dist</span>,
                                        bp.thresh.dist <span class="op">=</span> <span class="va">bp.thresh.dist</span>,
                                        max.dist <span class="op">=</span> <span class="va">max.dist</span><span class="op">)</span>
<span class="co"># AclustsCCA only considers clusters with at least two probes</span>
<span class="va">clusters.list</span> <span class="op">&lt;-</span> <span class="va">all.clusters.list</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">all.clusters.list</span>,<span class="va">length</span><span class="op">)</span><span class="op">!=</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="obtain-partial-residuals-to-adjust-for-potential-confounders">4.2 Obtain partial residuals to adjust for potential confounders<a class="anchor" aria-label="anchor" href="#obtain-partial-residuals-to-adjust-for-potential-confounders"></a>
</h3>
<p>When implementing SparseCCA, partial residuals are used to adjust for potential confounders. Again, computing partial residuals have to be ran only once. I personally suggest to run this part separately and save it for future use.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X.resid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/partial.residual.html">partial.residual</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">DATA.X</span>,Z<span class="op">=</span><span class="va">Z</span>,nthread<span class="op">=</span><span class="va">nthread</span><span class="op">)</span>
<span class="va">Y.resid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/partial.residual.html">partial.residual</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">DATA.Y</span>,Z<span class="op">=</span><span class="va">Z</span>,nthread<span class="op">=</span><span class="va">nthread</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="implement-sparsecca-and-permutation-test-on-each-cluster-identified-by-a-clustering">4.3 Implement SparseCCA and permutation test on each cluster identified by A-clustering<a class="anchor" aria-label="anchor" href="#implement-sparsecca-and-permutation-test-on-each-cluster-identified-by-a-clustering"></a>
</h3>
<p>As list of clusters are provided and partial residuals are computed, <code>AclustsCCA</code> will only run SparseCCA on each cluster identified by A-clustering.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">AclustsCCA.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/AclustsCCA.html">AclustsCCA</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">X.resid</span>,
                                Y<span class="op">=</span><span class="va">Y.resid</span>,
                                clusters.list<span class="op">=</span><span class="va">clusters.list</span>,
                                <span class="co"># parameters for SparseCCA</span>
                                Xmethod<span class="op">=</span><span class="va">Xmethod</span>,
                                Ymethod<span class="op">=</span><span class="va">Ymethod</span>,
                                <span class="co"># parameters for permutation test for AclustsCCA</span>
                                maxB<span class="op">=</span><span class="va">maxB</span>,
                                permute<span class="op">=</span><span class="cn">T</span>,
                                nthread<span class="op">=</span><span class="fl">3</span><span class="op">)</span> </code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jenny Lee.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
